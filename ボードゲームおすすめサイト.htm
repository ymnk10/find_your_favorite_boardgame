<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=shift_jis">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:游明朝;
	panose-1:2 2 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@游明朝";}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0mm;
	text-align:justify;
	text-justify:inter-ideograph;
	font-size:10.5pt;
	font-family:"游明朝",serif;}
.MsoChpDefault
	{font-family:"游明朝",serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:99.25pt 30.0mm 30.0mm 30.0mm;
	layout-grid:18.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=JA style='word-wrap:break-word;text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:18.0pt'>

<p class=MsoNormal><span lang=EN-US>#</span>ボードゲーム<span lang=EN-US>10</span>段階表示</p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;shiny&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;magrittr&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;bslib&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;lsa&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;tidyverse&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>ui &lt;- fluidPage(</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; theme =
bs_theme(bootswatch = &quot;minty&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; titlePanel(&quot;Board
game recommendation site&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; p(&quot;Welcome to the
board game recommendation site!&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; p(&quot;Please enter
your rating for the following board games on a scale of 1-10.&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; p(&quot;Please enter 0
for board games you have never played or do not know.&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; fluidRow(</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i01&quot;, label=&quot;6 nimmt!&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i02&quot;, label=&quot;Azul&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i03&quot;, label=&quot;Battle Line&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; ),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; fluidRow(</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i04&quot;, label=&quot;Catan&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i05&quot;, label=&quot;Dixit&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i06&quot;, label=&quot;Dominion&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; ),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; fluidRow(</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i07&quot;, label=&quot;Power Grid&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i08&quot;, label=&quot;Pandemic&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i09&quot;, label=&quot;Patchwork&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; ),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; fluidRow(</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i10&quot;, label=&quot;Love Letter&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;column(4,
sliderInput(&quot;i11&quot;, label=&quot;Machi Koro&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1)),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
column(4, sliderInput(&quot;i12&quot;, label=&quot;Splendor&quot;, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
min=0, max=10, value=0, step=1))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; ),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; actionButton(&quot;recommend&quot;,
&quot;View Results&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; hr(),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
textOutput(&quot;text&quot;),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
tableOutput(&quot;suisen&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>server &lt;- function(input, output) {</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
read_csv(&quot;user_rating_mat.csv&quot;) -&gt; user_rating_mat</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
read_csv(&quot;bgg-15m-reviews.csv&quot;) -&gt; boardgame</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; user_rating_mat
%&lt;&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mutate(across(.cols=everything(),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
~ replace_na(.x, 0)))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; user_rating_mat %&gt;%
as.matrix() -&gt; urmat</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;
observeEvent(input$recommend,{</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
me &lt;- c(input$i01, input$i02, input$i03,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
input$i04,input$i05, input$i06, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
input$i07, input$i08,input$i09, </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
input$i10, input$i11, input$i12)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
me.vect &lt;- rep(0, ncol(urmat))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
me.item &lt;- c(&quot;6 nimmt!&quot;,&quot;Azul&quot;, &quot;Battle Line&quot;,
&quot;Catan&quot;,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Dixit&quot;, &quot;Dominion&quot;,&quot;Power
Grid&quot;,&quot;Pandemic&quot;,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Patchwork&quot;,&quot;Love Letter&quot;,&quot;Machi
Koro&quot;,&quot;Splendor&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
me.loc &lt;- match(me.item, names(user_rating_mat))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
for(i in 1:length(me)){</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
me.vect[me.loc[i]] &lt;- me[i]</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
library(&quot;lsa&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
n &lt;- nrow(urmat)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ruijido &lt;- rep(0, n)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
for(i in 1:n){</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ruijido[i] &lt;- cosine(me.vect , as.vector(urmat[i,]))</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user_rating_mat %&lt;&gt;% tibble(ruijido)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user_rating_mat %&gt;% top_n(10, ruijido) -&gt;upper</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
upper %&gt;% select(!ruijido) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
as.matrix() -&gt; upper.rating</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
upper %&gt;% pull(ruijido) -&gt; upper.ruijido</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tibble(name=me.item,
rating=me) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
filter(rating!=0) -&gt; notrecommend</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
upper.ruijido %&gt;% sum() -&gt; sum.ruijido</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
upper.rating %&gt;% t() %*%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
upper.ruijido / sum.ruijido -&gt; yosoku</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
yosoku %&gt;% rownames() -&gt; name3</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
tibble(name=name3,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pred.rating=yosoku[,1]) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
arrange(desc(pred.rating)) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
anti_join(notrecommend , by=&quot;name&quot;) %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
filter(pred.rating &gt;=7) %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
left_join(name1.1 , by=&quot;name&quot;) -&gt; recommend.boardgame</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
output$text &lt;- renderText({&quot;Recommended board games for you!!&quot;})</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
output$suisen &lt;- renderTable({recommend.boardgame})</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp; })</span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>shinyApp(ui, server)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>#</span>ボードゲーム類似度計算</p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;tidyverse&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;magrittr&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>boardgame &lt;-
read_csv(&quot;bgg-15m-reviews.csv&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>boardgame %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; group_by(name) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; summarise(rating=n()) -&gt; name0</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>name0 %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; filter(rating &gt;= 8000) -&gt;
name1</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>name1 %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; select(!rating) -&gt; name1.1</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>boardgame %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; select(name, user, rating) %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; semi_join(name1,
by=&quot;name&quot;)-&gt; name2</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>name2 %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; group_by(user) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; summarise(rating=n()) %&gt;%
filter(rating &gt;= 150) -&gt; user</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>name2 %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; semi_join(user, by=&quot;user&quot;)
-&gt; user2</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>user2 %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; pivot_wider(names_from = name ,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
values_from=rating , values_fn=mean) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; select(!user)-&gt; user_rating_mat</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>write_csv(user_rating_mat,
&quot;user_rating_mat.csv&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>write_csv(name1, &quot;name1.csv&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>user_rating_mat %&lt;&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; mutate(across(everything(),</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
~ replace_na(.x, 0)))</span></p>

<p class=MsoNormal><span lang=EN-US>user_rating_mat %&gt;% as.matrix() -&gt;
urmat</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>me &lt;- c(10, 9, 8, 0, 7, 7, 0, 4, 9, 0,
8, 7)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>me.vect &lt;- rep(0, ncol(urmat))</span></p>

<p class=MsoNormal><span lang=EN-US>me.item &lt;- c(&quot;6
nimmt!&quot;,&quot;Azul&quot;, &quot;Battle Line&quot;, &quot;Catan&quot;,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Dixit&quot;, &quot;Dominion&quot;,&quot;Power
Grid&quot;,&quot;Pandemic&quot;,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&quot;Patchwork&quot;,&quot;Love Letter&quot;,&quot;Machi
Koro&quot;,&quot;Splendor&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>me.loc &lt;- match(me.item,
names(user_rating_mat))</span></p>

<p class=MsoNormal><span lang=EN-US>for(i in 1:length(me)){</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; me.vect[me.loc[i]] &lt;- me[i]</span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>library(&quot;lsa&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US>n &lt;- nrow(urmat)</span></p>

<p class=MsoNormal><span lang=EN-US>ruijido &lt;- rep(0, n)</span></p>

<p class=MsoNormal><span lang=EN-US>for(i in 1:n){</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; ruijido[i] &lt;- cosine(me.vect ,
as.vector(urmat[i,]))</span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>user_rating_mat %&lt;&gt;% tibble(ruijido)</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>user_rating_mat %&gt;% top_n(10, ruijido)
-&gt;upper</span></p>

<p class=MsoNormal><span lang=EN-US>upper %&gt;% select(!ruijido) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; as.matrix() -&gt; upper.rating</span></p>

<p class=MsoNormal><span lang=EN-US>upper %&gt;% pull(ruijido) -&gt;
upper.ruijido</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>tibble(name=me.item, rating=me) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; filter(rating!=0) -&gt; notrecommend</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>upper.ruijido %&gt;% sum() -&gt;
sum.ruijido</span></p>

<p class=MsoNormal><span lang=EN-US>upper.rating %&gt;% t() %*%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; upper.ruijido / sum.ruijido -&gt;
yosoku</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>yosoku %&gt;% rownames() -&gt; name3</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>tibble(name=name3,</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pred.rating=yosoku[,1]) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; arrange(desc(pred.rating)) %&gt;% </span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; anti_join(notrecommend ,
by=&quot;name&quot;) %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; filter(pred.rating &gt;=6) %&gt;%</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp; left_join(name1 , by=&quot;name&quot;)
-&gt; recommend.boardgame</span></p>

</div>

</body>

</html>
